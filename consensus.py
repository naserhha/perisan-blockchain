# ماژول الگوریتم اجماع (اثبات سهام - PoS) برای PersianChain
# نویسنده: Mohammad Nasser Haji Hashemabad
# توضیحات: این ماژول انتخاب ماینر را بر اساس موجودی (stake) انجام می‌دهد.
import random

class اثبات_سهام:
    def __init__(self, وضعیت_حساب_ها):
        self.وضعیت_حساب_ها = وضعیت_حساب_ها  # دیکشنری: {آدرس: موجودی}

    def انتخاب_ماینر(self):
        # فقط حساب‌هایی که stake مثبت دارند
        شرکت_کنندگان = [(آدرس, موجودی) for آدرس, موجودی in self.وضعیت_حساب_ها.items() if موجودی > 0]
        if not شرکت_کنندگان:
            return None
        # انتخاب تصادفی با وزن موجودی
        آدرس_ها = [آدرس for آدرس, موجودی in شرکت_کنندگان]
        وزن_ها = [موجودی for آدرس, موجودی in شرکت_کنندگان]
        انتخاب = random.choices(آدرس_ها, weights=وزن_ها, k=1)[0]
        return انتخاب

# نمونه استفاده
if __name__ == "__main__":
    وضعیت = {
        'کاربر۱': 100,
        'کاربر۲': 50,
        'کاربر۳': 0
    }
    pos = اثبات_سهام(وضعیت)
    انتخاب_ها = [pos.انتخاب_ماینر() for _ in range(10)]
    print("انتخاب ماینرها در ۱۰ دور:", انتخاب_ها) 